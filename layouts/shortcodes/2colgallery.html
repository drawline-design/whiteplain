{{- if not ($.Page.Scratch.Get "gallery") }}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.4.0/jquery.fancybox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.4.0/jquery.fancybox.min.js"></script>
<script>
	$(window).on('load resize', function(){
		itemWidth = $('.item').width();
		$('.item').height(itemWidth);
		itemMargin = $('.item').outerWidth(true)-$('.item').height();
		$('.item').css('margin-bottom', itemMargin*2+'px')
	});
</script>
{{ else }}
{{ end }}
{{- $.Page.Scratch.Add "gallery" 1 }}
<style>
	div.item {
		width:49.5%;
		float:left;
		display:block;
		background-size:cover;
		background-position:center top;
	}
	div.item:nth-child(odd){
		margin-right:.5%;
	}
	div.item:nth-child(even){
		margin-left:.5%;
	}
	div.item a {
		width:100%;
		height:100%;
		display:block;
	}
</style>

<div class="gallery">
	{{ $path := print "/static" (.Get "dir") "/thumbs" }}
  {{ $srcPath := print "" (.Get "dir") }}
  {{ $thumbPath := print (.Get "dir") "/thumbs" }}
  {{ range (readDir $path) }}
  {{ $src := print $srcPath "/" .Name }}
  {{ $thumbsrc := print $thumbPath "/" .Name }}
  <div class="item" style="background-image:url({{$thumbsrc}});"><a data-fancybox="gallery" href="{{$src}}"> </a></div>
  {{ end }}
</div>
<p><br clear="all" /></p>
